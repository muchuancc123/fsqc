window.addEventListener('error',function(e){try{var app=document.getElementById('app')||document.body;var container=document.createElement('div');container.className='container';var card=document.createElement('div');card.className='card';var title=document.createElement('div');title.className='title';title.textContent='页面加载失败';var sub=document.createElement('div');sub.className='sub';sub.style.color='red';var msg=(e.message||'未知错误')+(e.filename?(' @ '+e.filename+':'+e.lineno+':'+e.colno):'');sub.textContent=msg;var tip=document.createElement('div');tip.className='sub';tip.textContent='请按 Ctrl+F5 强制刷新，或联系支持';card.append(title,sub,tip);container.append(card);app.innerHTML='';app.append(container)}catch(err){}},true);
window.onerror=function(message,source,lineno,colno,error){try{var app=document.getElementById('app')||document.body;var container=document.createElement('div');container.className='container';var card=document.createElement('div');card.className='card';var title=document.createElement('div');title.className='title';title.textContent='脚本语法错误';var sub=document.createElement('div');sub.className='sub';sub.style.color='red';sub.textContent=String(message||'未知错误')+' @ '+String(source||'')+':'+String(lineno||'')+':'+String(colno||'');card.append(title,sub);container.append(card);app.innerHTML='';app.append(container)}catch(err){}return true};
window.addEventListener('unhandledrejection',function(e){try{var app=document.getElementById('app')||document.body;var container=document.createElement('div');container.className='container';var card=document.createElement('div');card.className='card';var title=document.createElement('div');title.className='title';title.textContent='脚本运行错误';var sub=document.createElement('div');sub.className='sub';sub.style.color='red';sub.textContent=String(e.reason||'未知错误');card.append(title,sub);container.append(card);app.innerHTML='';app.append(container)}catch(err){}},true);
